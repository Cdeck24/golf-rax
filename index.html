<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golf Yearly Rax Tracker</title>
    <!-- React and Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #05070a;
            /* Fairway Pattern */
            background-image: repeating-linear-gradient(
                45deg,
                rgba(16, 185, 129, 0.02) 0px,
                rgba(16, 185, 129, 0.02) 100px,
                rgba(16, 185, 129, 0.04) 100px,
                rgba(16, 185, 129, 0.04) 200px
            );
        }
        /* Custom scrollbar for webkit */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #0a0f18; }
        ::-webkit-scrollbar-thumb { background: #1f2937; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #10b981; }

        .golf-ball-rank {
            background: radial-gradient(circle at 30% 30%, #ffffff 0%, #e5e7eb 100%);
            box-shadow: inset -1px -1px 2px rgba(0,0,0,0.2), 1px 1px 3px rgba(0,0,0,0.5);
        }

        .glass-card {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body class="text-gray-100 min-h-screen relative selection:bg-emerald-500/30">
    
    <!-- Ambient Background Lighting -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none z-0">
        <div class="absolute -top-[10%] -left-[10%] w-[40%] h-[40%] rounded-full bg-emerald-900/10 blur-[120px]"></div>
        <div class="absolute bottom-[10%] -right-[10%] w-[30%] h-[40%] rounded-full bg-emerald-800/5 blur-[120px]"></div>
    </div>

    <div id="root" class="relative z-10"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Constants ---
        const RARITIES = [
            { label: 'General (1x)', value: 1 },
            { label: 'Common (2x)', value: 2 },
            { label: 'Uncommon (3x)', value: 3 },
            { label: 'Rare (4x)', value: 4 },
            { label: 'Epic (10x)', value: 10 },
            { label: 'Legendary 1 (25x)', value: 25 },
            { label: 'Legendary 2 (28x)', value: 28 },
            { label: 'Legendary 3 (32x)', value: 32 },
            { label: 'Legendary 4 (35x)', value: 35 },
            { label: 'Legendary 5 (40x)', value: 40 },
            { label: 'Mystic 1 (75x)', value: 75 },
            { label: 'Mystic 2 (79x)', value: 79 },
            { label: 'Mystic 3 (83x)', value: 83 },
            { label: 'Mystic 4 (87x)', value: 87 },
            { label: 'Mystic 5 (91x)', value: 91 },
            { label: 'Mystic 6 (95x)', value: 95 },
            { label: 'Mystic 7 (98x)', value: 98 },
            { label: 'Mystic 8 (101x)', value: 101 },
            { label: 'Mystic 9 (103x)', value: 103 },
            { label: 'Mystic 10 (105x)', value: 105 },
            { label: 'Iconic 1 (150x)', value: 150 },
            { label: 'Iconic 2 (153x)', value: 153 },
            { label: 'Iconic 3 (156x)', value: 156 },
            { label: 'Iconic 4 (159x)', value: 159 },
            { label: 'Iconic 5 (163x)', value: 163 },
            { label: 'Iconic 6 (167x)', value: 167 },
            { label: 'Iconic 7 (171x)', value: 171 },
            { label: 'Iconic 8 (175x)', value: 175 },
            { label: 'Iconic 9 (180x)', value: 180 },
            { label: 'Iconic 10 (185x)', value: 185 },
            { label: 'Iconic 11 (190x)', value: 190 },
            { label: 'Iconic 12 (196x)', value: 196 },
            { label: 'Iconic 13 (202x)', value: 202 },
            { label: 'Iconic 14 (208x)', value: 208 },
            { label: 'Iconic 15 (214x)', value: 214 },
            { label: 'Iconic 16 (220x)', value: 220 },
            { label: 'Iconic 17 (226x)', value: 226 },
            { label: 'Iconic 18 (233x)', value: 233 },
            { label: 'Iconic 19 (240x)', value: 240 },
            { label: 'Iconic 20 (250x)', value: 250 }
        ];

        // --- SVGs & Icons ---
        const GolfPinIcon = ({size=24, className=""}) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
                <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path>
                <line x1="4" y1="22" x2="4" y2="15"></line>
            </svg>
        );

        const UploadIcon = ({size=24, className=""}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>;
        const CalendarXIcon = ({size=24, className=""}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line><line x1="10" y1="14" x2="14" y2="18"></line><line x1="14" y1="14" x2="10" y2="18"></line></svg>;
        const SearchIcon = ({size=24, className=""}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>;
        const ChevronIcon = ({expanded, className=""}) => <svg className={`transition-transform duration-300 ${expanded ? 'rotate-180' : ''} ${className}`} xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>;

        // --- Data Parsers ---
        const normalizeEvents = (jsonData, sourceYear) => {
            let events = [];
            let localNames = {}; 
            
            const findNames = (obj) => {
                if (!obj || typeof obj !== 'object') return;
                if (obj.first_name || obj.last_name) {
                    const name = `${obj.first_name || ''} ${obj.last_name || ''}`.trim();
                    if (name && obj.player_id) localNames[String(obj.player_id)] = name;
                }
                for (let key in obj) {
                    const child = obj[key];
                    if (child && typeof child === 'object') {
                        if (child.first_name || child.last_name) {
                            const name = `${child.first_name || ''} ${child.last_name || ''}`.trim();
                            if (name) {
                                localNames[key] = name;
                                if (child.player_id) localNames[String(child.player_id)] = name;
                            }
                        }
                        findNames(child);
                    }
                }
            };
            findNames(jsonData);

            const findEvents = (obj, potentialPlayerId) => {
                if (!obj || typeof obj !== 'object') return;
                const dateKey = Object.keys(obj).find(k => /^(date|time)$/i.test(k));
                const raxKey = Object.keys(obj).find(k => /^(earnings|rax|score)$/i.test(k));

                if (dateKey && raxKey) {
                    const rax = obj[raxKey];
                    const gId = String(obj.player_id || obj.Player_ID || potentialPlayerId);
                    if (typeof obj[dateKey] === 'string' && obj[dateKey].trim() !== '') {
                        const dateStr = String(obj[dateKey]);
                        let extractedYear = null;
                        const yMatch = dateStr.match(/\b(20\d{2})\b/);
                        if (yMatch) extractedYear = parseInt(yMatch[1]);
                        events.push({
                            date: dateStr,
                            year: extractedYear || sourceYear || new Date().getFullYear(),
                            golferId: gId,
                            rax: parseFloat(rax) || 0
                        });
                    }
                    return;
                }

                for (let key in obj) {
                    if (/^(first_name|last_name|player_id|total_earnings)$/i.test(key)) continue;
                    const child = obj[key];
                    if (child && typeof child === 'object') {
                        let nextId = potentialPlayerId;
                        const childDateKey = Object.keys(child).find(k => /^(date|time)$/i.test(k));
                        const childRaxKey = Object.keys(child).find(k => /^(earnings|rax|score)$/i.test(k));
                        if (!(childDateKey && childRaxKey) && !Array.isArray(obj)) {
                            nextId = key;
                        }
                        findEvents(child, nextId);
                    }
                }
            };
            
            findEvents(jsonData, "Unknown");
            return { events, names: localNames };
        };

        const App = () => {
            const [events, setEvents] = useState([]);
            const [golferNames, setGolferNames] = useState({});
            const [dataLoaded, setDataLoaded] = useState(false);
            const [isLoading, setIsLoading] = useState(true);
            const [viewMode, setViewMode] = useState('seasons'); 
            const [searchQuery, setSearchQuery] = useState('');
            const [expandedPlayer, setExpandedPlayer] = useState(null);
            const [expandedYearPlayer, setExpandedYearPlayer] = useState(null);
            const [selectedYear, setSelectedYear] = useState('');
            const [currentMultiplier, setCurrentMultiplier] = useState(1);

            const deduplicateEvents = (eventList) => {
                const map = new Map();
                eventList.forEach(e => {
                    const key = `dedupe_${e.golferId}_${e.year}_${e.date}_${e.rax}`;
                    map.set(key, e);
                });
                return Array.from(map.values());
            };

            useEffect(() => {
                const attemptAutoFetch = async () => {
                    setIsLoading(true);
                    let loadedAny = false;
                    let allEvents = [];
                    let allNames = {};
                    try {
                        for (let y = 2014; y <= 2025; y++) {
                            try {
                                const jRes = await fetch(`/golf-otd/${y}-golf-data.json`);
                                if (jRes.ok) {
                                    const parsed = normalizeEvents(await jRes.json(), y);
                                    allEvents = allEvents.concat(parsed.events);
                                    allNames = { ...allNames, ...parsed.names };
                                    loadedAny = true;
                                }
                            } catch (e) {}
                        }
                    } catch (e) {}
                    if (loadedAny && allEvents.length > 0) {
                        setEvents(deduplicateEvents(allEvents));
                        setGolferNames(allNames);
                        setDataLoaded(true);
                    }
                    setIsLoading(false);
                };
                attemptAutoFetch();
            }, []);

            const handleFiles = async (e) => {
                setIsLoading(true);
                const files = Array.from(e.target.files);
                let newEvents = [];
                let newNames = {};
                for (let file of files) {
                    if (file.name.toLowerCase().endsWith('.json')) {
                        try {
                            const json = JSON.parse(await file.text());
                            const yearMatch = file.name.match(/(\d{4})/);
                            const parsed = normalizeEvents(json, yearMatch ? parseInt(yearMatch[1]) : null);
                            newEvents = newEvents.concat(parsed.events);
                            newNames = { ...newNames, ...parsed.names };
                        } catch(err) {}
                    }
                }
                setEvents(prev => deduplicateEvents([...prev, ...newEvents]));
                setGolferNames(prev => ({...prev, ...newNames}));
                setDataLoaded(true);
                setIsLoading(false);
            };

            const getDisplayName = (gId) => golferNames[gId] || (/^\d+$/.test(gId) ? `Golfer ID: ${gId}` : gId);

            const adjustedEvents = useMemo(() => events.map(e => ({ ...e, rax: e.rax * currentMultiplier })), [events, currentMultiplier]);

            const yearGroups = useMemo(() => {
                const groups = {};
                adjustedEvents.forEach(e => {
                    if (!groups[e.year]) groups[e.year] = { total: 0, golfers: {} };
                    groups[e.year].total += e.rax;
                    if (!groups[e.year].golfers[e.golferId]) groups[e.year].golfers[e.golferId] = { total: 0, events: [] };
                    groups[e.year].golfers[e.golferId].total += e.rax;
                    groups[e.year].golfers[e.golferId].events.push(e);
                });
                return groups;
            }, [adjustedEvents]);
            
            const sortedYears = Object.keys(yearGroups).sort((a,b) => b - a);

            useEffect(() => {
                if (sortedYears.length > 0 && !selectedYear) setSelectedYear(sortedYears[0]);
            }, [sortedYears, selectedYear]);

            const golferAggregates = useMemo(() => {
                const groups = {};
                adjustedEvents.forEach(e => {
                    if (!groups[e.golferId]) groups[e.golferId] = { total: 0, years: {} };
                    groups[e.golferId].total += e.rax;
                    groups[e.golferId].years[e.year] = (groups[e.golferId].years[e.year] || 0) + e.rax;
                });
                Object.keys(groups).forEach(gId => {
                    const years = groups[gId].years;
                    groups[gId].bestSeasonRax = Math.max(...Object.values(years));
                    groups[gId].bestSeasonYear = Object.keys(years).find(y => years[y] === groups[gId].bestSeasonRax);
                });
                return groups;
            }, [adjustedEvents]);
            
            const sortedTopGolfers = Object.keys(golferAggregates).sort((a,b) => golferAggregates[b].bestSeasonRax - golferAggregates[a].bestSeasonRax);

            const topSeasons = useMemo(() => {
                const seasons = [];
                Object.keys(golferAggregates).forEach(gId => {
                    Object.keys(golferAggregates[gId].years).forEach(year => {
                        seasons.push({ golferId: gId, year, rax: golferAggregates[gId].years[year] });
                    });
                });
                return seasons.sort((a, b) => b.rax - a.rax);
            }, [golferAggregates]);

            return (
                <div className="pb-12 sm:pb-24 overflow-x-hidden">
                    {/* Header */}
                    <header className="bg-gray-950/80 backdrop-blur-xl border-b border-emerald-500/20 sticky top-0 z-50 shadow-lg">
                        <div className="max-w-4xl mx-auto flex justify-between items-center p-3 sm:p-5 px-4 sm:px-6">
                            <h1 className="text-lg sm:text-xl md:text-2xl font-black tracking-tighter flex items-center gap-2 sm:gap-3 text-white uppercase">
                                <div className="p-1.5 sm:p-2 bg-emerald-500/20 rounded-lg sm:rounded-xl text-emerald-400 border border-emerald-500/30">
                                    <GolfPinIcon size={20} className="sm:w-[22px] sm:h-[22px]" />
                                </div>
                                Golf Rax Tracker
                            </h1>
                        </div>
                    </header>
                    
                    <main className="w-full max-w-4xl mx-auto mt-4 sm:mt-8 px-2 sm:px-4 md:px-6">
                        {isLoading && !dataLoaded ? (
                            <div className="flex flex-col items-center justify-center p-12 sm:p-20 text-gray-500 animate-pulse glass-card rounded-2xl sm:rounded-3xl mx-2">
                                <SearchIcon size={40} className="mb-4 opacity-50 animate-spin text-emerald-500 sm:w-12 sm:h-12" />
                                <p className="text-base sm:text-lg font-bold tracking-widest uppercase">Consulting Scorecards...</p>
                            </div>
                        ) : !dataLoaded ? (
                            <div className="glass-card p-8 sm:p-10 md:p-16 rounded-2xl sm:rounded-3xl shadow-2xl text-center relative overflow-hidden mx-2">
                                <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-600 to-emerald-400"></div>
                                <div className="w-16 h-16 sm:w-20 sm:h-20 bg-gray-900 text-emerald-500 rounded-full flex items-center justify-center mx-auto mb-5 sm:mb-6 shadow-inner border border-emerald-500/30">
                                    <UploadIcon size={32} className="sm:w-9 sm:h-9" />
                                </div>
                                <h2 className="text-2xl sm:text-3xl font-black mb-2 sm:mb-3 text-white tracking-tight uppercase">Data Required</h2>
                                <p className="text-sm sm:text-lg text-gray-400 mb-8 sm:mb-10 max-w-md mx-auto leading-relaxed font-medium">
                                    Please manually load your scorecard JSON files to populate the leaderboard.
                                </p>
                                
                                <label className="cursor-pointer bg-emerald-600 hover:bg-emerald-500 text-white px-6 sm:px-8 py-3 sm:py-4 rounded-xl font-black uppercase tracking-widest inline-flex items-center gap-2 sm:gap-3 shadow-lg shadow-emerald-900/40 transition-all hover:scale-105 hover:-translate-y-1 text-sm sm:text-base">
                                    <UploadIcon size={18} className="sm:w-5 sm:h-5" />
                                    Import Files
                                    <input type="file" multiple accept=".json" className="hidden" onChange={handleFiles} />
                                </label>
                            </div>
                        ) : (
                            <div className="animate-fade-in space-y-6 sm:space-y-8 px-1 sm:px-0">
                                
                                {/* Navigation & Rarity Selector */}
                                {events.length > 0 && (
                                    <div className="flex flex-col items-center pb-2 sm:pb-4 gap-4 sm:gap-5 pt-2 sm:pt-0 mx--2 px-2 sm:mx-0 sm:px-0">
                                        <div className="flex glass-card p-1 sm:p-1.5 rounded-xl sm:rounded-2xl shadow-xl w-full sm:w-auto inline-grid grid-cols-3 mx-auto">
                                            <button 
                                                onClick={() => setViewMode('seasons')}
                                                className={`whitespace-nowrap px-3 sm:px-6 py-2 sm:py-3 rounded-lg sm:rounded-xl font-black text-[10px] sm:text-xs uppercase tracking-widest transition-all duration-300 ${viewMode === 'seasons' ? 'bg-emerald-600 text-white shadow-md' : 'text-gray-400 hover:text-white hover:bg-gray-800/50'}`}>
                                                Seasons
                                            </button>
                                            <button 
                                                onClick={() => setViewMode('investments')}
                                                className={`whitespace-nowrap px-3 sm:px-6 py-2 sm:py-3 rounded-lg sm:rounded-xl font-black text-[10px] sm:text-xs uppercase tracking-widest transition-all duration-300 mx-1 ${viewMode === 'investments' ? 'bg-emerald-600 text-white shadow-md' : 'text-gray-400 hover:text-white hover:bg-gray-800/50'}`}>
                                                Players
                                            </button>
                                            <button 
                                                onClick={() => setViewMode('years')}
                                                className={`whitespace-nowrap px-3 sm:px-6 py-2 sm:py-3 rounded-lg sm:rounded-xl font-black text-[10px] sm:text-xs uppercase tracking-widest transition-all duration-300 ${viewMode === 'years' ? 'bg-emerald-600 text-white shadow-md' : 'text-gray-400 hover:text-white hover:bg-gray-800/50'}`}>
                                                By Year
                                            </button>
                                        </div>
                                        
                                        <div className="flex items-center justify-between sm:justify-start gap-2 sm:gap-3 bg-gray-900/90 border border-gray-800 rounded-xl sm:rounded-2xl px-3 sm:px-4 py-1.5 sm:py-2.5 shadow-xl w-full sm:w-auto">
                                            <span className="text-[10px] sm:text-xs font-black text-gray-500 uppercase tracking-widest hidden sm:inline-block">Rarity Multiplier</span>
                                            <div className="relative flex-1 sm:flex-none">
                                                <select 
                                                    value={currentMultiplier}
                                                    onChange={(e) => setCurrentMultiplier(parseFloat(e.target.value))}
                                                    className="appearance-none bg-gray-950 border border-emerald-500/20 text-emerald-400 font-black rounded-lg sm:rounded-xl pl-3 pr-8 sm:pl-4 sm:pr-10 py-1.5 sm:py-2 text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/20 transition-all cursor-pointer shadow-inner w-full sm:w-auto"
                                                >
                                                    {RARITIES.map(r => (
                                                        <option key={r.label} value={r.value}>{r.label}</option>
                                                    ))}
                                                </select>
                                                <div className="absolute inset-y-0 right-0 flex items-center pr-2 sm:pr-3 pointer-events-none text-emerald-500">
                                                    <ChevronIcon expanded={false} className="w-3 h-3 sm:w-4 sm:h-4" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Results Rendering */}
                                {sortedYears.length === 0 ? (
                                    <div className="text-center p-12 sm:p-16 glass-card rounded-2xl sm:rounded-3xl text-gray-500">
                                        <CalendarXIcon size={48} className="mx-auto mb-4 opacity-20 sm:w-16 sm:h-16" />
                                        <h3 className="text-xl sm:text-2xl font-black text-gray-300 tracking-tight uppercase">Leaderboard Empty</h3>
                                        <p className="mt-2 text-sm sm:text-lg font-medium">Please import JSON scorecards.</p>
                                    </div>
                                ) : (
                                    <div className="space-y-6 sm:space-y-8">
                                        
                                        {/* Player Search View */}
                                        {viewMode === 'investments' && (
                                            <div className="glass-card rounded-2xl sm:rounded-3xl shadow-2xl flex flex-col overflow-hidden" style={{ height: 'calc(100vh - 200px)', minHeight: '400px' }}>
                                                <div className="bg-gray-900/60 px-4 sm:px-6 md:px-8 py-4 border-b border-gray-800 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-4 shrink-0">
                                                    <h3 className="text-lg sm:text-xl font-black text-white tracking-tighter uppercase hidden sm:block">Leaderboard</h3>
                                                    <div className="relative w-full sm:max-w-xs">
                                                        <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                            <SearchIcon size={14} className="text-emerald-500" />
                                                        </div>
                                                        <input
                                                            type="text"
                                                            placeholder="SEARCH PLAYERS..."
                                                            className="w-full bg-gray-950 border border-gray-800 text-gray-100 rounded-lg pl-8 sm:pl-9 pr-4 py-2 text-[10px] sm:text-xs font-bold focus:outline-none focus:ring-2 focus:ring-emerald-500/20 transition-all placeholder-gray-600 uppercase"
                                                            value={searchQuery}
                                                            onChange={(e) => setSearchQuery(e.target.value)}
                                                        />
                                                    </div>
                                                </div>

                                                <div className="bg-emerald-950/20 border-b border-emerald-500/10 px-4 sm:px-8 py-2.5 shrink-0">
                                                    <p className="text-[9px] sm:text-[10px] text-emerald-400 font-black tracking-widest uppercase italic opacity-80">
                                                        Note: Totals assume ownership of all seasonal cards.
                                                    </p>
                                                </div>
                                                
                                                <div className="overflow-y-auto overflow-x-hidden flex-1 no-scrollbar">
                                                    <ul className="divide-y divide-gray-800/50">
                                                        {sortedTopGolfers
                                                            .filter(gId => getDisplayName(gId).toLowerCase().includes(searchQuery.toLowerCase()))
                                                            .map((gId, index) => {
                                                                const data = golferAggregates[gId];
                                                                const sortedSeasons = Object.keys(data.years)
                                                                    .map(year => ({ year, rax: data.years[year] }))
                                                                    .sort((a, b) => b.rax - a.rax);
                                                                const isExpanded = expandedPlayer === gId;

                                                                return (
                                                                    <li key={gId} className="flex flex-col group border-l-4 border-transparent hover:border-emerald-500 transition-all">
                                                                        <button 
                                                                            onClick={() => setExpandedPlayer(isExpanded ? null : gId)}
                                                                            className="px-4 sm:px-6 md:px-8 py-4 sm:py-5 flex flex-row justify-between items-center hover:bg-emerald-500/5 transition-all text-left gap-3 w-full"
                                                                        >
                                                                            <div className="flex items-center gap-3 sm:gap-5 truncate">
                                                                                <div className="flex shrink-0 items-center justify-center w-7 h-7 sm:w-8 sm:h-8 rounded-full golf-ball-rank text-[10px] sm:text-xs font-black text-gray-900 border border-gray-300">
                                                                                    {index + 1}
                                                                                </div>
                                                                                <div className="truncate">
                                                                                    <div className="font-black text-gray-100 text-sm sm:text-lg tracking-tight uppercase group-hover:text-emerald-400 transition-colors truncate">
                                                                                        {getDisplayName(gId)}
                                                                                    </div>
                                                                                    <div className="text-[9px] sm:text-[10px] text-emerald-500 mt-0.5 sm:mt-1 font-black tracking-widest uppercase truncate opacity-80">
                                                                                        Best: {data.bestSeasonYear} Season
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div className="text-right flex items-center gap-3 sm:gap-4 shrink-0 pl-2">
                                                                                <span className="text-gray-100 font-black text-lg sm:text-xl tracking-tighter">
                                                                                    {data.total.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 1 })}
                                                                                </span>
                                                                                <ChevronIcon expanded={isExpanded} className="text-gray-600 group-hover:text-emerald-500" />
                                                                            </div>
                                                                        </button>
                                                                        {isExpanded && (
                                                                            <div className="bg-gray-950/40 px-4 sm:px-8 py-3 sm:py-5 border-t border-gray-800 animate-fade-in">
                                                                                <ul className="space-y-1.5 sm:space-y-2">
                                                                                    {sortedSeasons.map((season, sIdx) => (
                                                                                        <li key={season.year} className="flex justify-between items-center p-2.5 sm:p-3.5 rounded-lg bg-gray-900/50 border border-gray-800 shadow-sm">
                                                                                            <div className="flex items-center gap-3">
                                                                                                <span className="text-gray-600 font-black text-[9px] sm:text-[10px] tracking-tighter w-4">{sIdx + 1}</span>
                                                                                                <span className="text-gray-300 font-bold text-xs sm:text-sm uppercase tracking-widest">{season.year} SEASON</span>
                                                                                            </div>
                                                                                            <div className="text-emerald-400 font-black tracking-tighter text-sm sm:text-lg">
                                                                                                {season.rax.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 1 })}
                                                                                            </div>
                                                                                        </li>
                                                                                    ))}
                                                                                </ul>
                                                                            </div>
                                                                        )}
                                                                    </li>
                                                                );
                                                            })}
                                                    </ul>
                                                </div>
                                            </div>
                                        )}

                                        {/* Best Seasons View */}
                                        {viewMode === 'seasons' && (
                                            <div className="glass-card rounded-2xl sm:rounded-3xl shadow-2xl flex flex-col overflow-hidden" style={{ height: 'calc(100vh - 200px)', minHeight: '400px' }}>
                                                <div className="bg-gray-900/60 px-4 sm:px-6 md:px-8 py-5 border-b border-gray-800 shrink-0">
                                                    <h3 className="text-lg sm:text-xl font-black text-white tracking-tighter uppercase">All-Time Seasons</h3>
                                                </div>
                                                <div className="overflow-y-auto overflow-x-hidden flex-1 no-scrollbar">
                                                    <ul className="divide-y divide-gray-800/50">
                                                        {topSeasons.map((season, index) => (
                                                            <li key={`${season.golferId}-${season.year}`} className="px-4 sm:px-6 md:px-8 py-4 sm:py-5 flex flex-row justify-between items-center hover:bg-emerald-500/5 transition-all group gap-3 border-l-4 border-transparent hover:border-emerald-500">
                                                                <div className="flex items-center gap-3 sm:gap-5 truncate">
                                                                    <div className={`flex shrink-0 items-center justify-center w-7 h-7 sm:w-8 sm:h-8 rounded-full golf-ball-rank text-[10px] sm:text-xs font-black text-gray-900 border border-gray-300 ${index < 3 ? 'ring-2 ring-emerald-500/30' : ''}`}>
                                                                        {index + 1}
                                                                    </div>
                                                                    <div className="truncate">
                                                                        <span className="font-black text-gray-100 text-sm sm:text-lg tracking-tight uppercase group-hover:text-emerald-400 transition-colors truncate">
                                                                            {getDisplayName(season.golferId)}
                                                                        </span>
                                                                        <div className="text-[9px] font-black bg-emerald-950/40 text-emerald-400 px-2 py-0.5 rounded border border-emerald-500/20 uppercase tracking-widest w-max mt-0.5">
                                                                            {season.year} Season
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div className="text-right flex items-baseline gap-1 shrink-0 pl-2">
                                                                    <span className="text-emerald-400 font-black text-xl sm:text-2xl tracking-tighter">
                                                                        {season.rax.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 1 })}
                                                                    </span>
                                                                </div>
                                                            </li>
                                                        ))}
                                                    </ul>
                                                </div>
                                            </div>
                                        )}

                                        {/* Year-by-Year View */}
                                        {viewMode === 'years' && (
                                            <div className="glass-card rounded-2xl sm:rounded-3xl shadow-2xl flex flex-col overflow-hidden" style={{ height: 'calc(100vh - 200px)', minHeight: '400px' }}>
                                                <div className="bg-gray-900/60 px-4 sm:px-6 md:px-8 py-4 sm:py-5 border-b border-gray-800 flex flex-row justify-between items-center gap-4 shrink-0">
                                                    <div className="flex items-center gap-3 flex-1">
                                                        <div className="relative w-full sm:w-auto">
                                                            <select 
                                                                value={selectedYear || ''} 
                                                                onChange={(e) => {
                                                                    setSelectedYear(e.target.value);
                                                                    setExpandedYearPlayer(null);
                                                                }}
                                                                className="appearance-none w-full bg-gray-950 border border-emerald-500/20 text-emerald-400 font-black rounded-lg sm:rounded-xl pl-4 pr-10 py-1.5 sm:py-2 text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/20 transition-all cursor-pointer shadow-inner uppercase tracking-widest"
                                                            >
                                                                {sortedYears.map(y => <option key={y} value={y}>{y} Season</option>)}
                                                            </select>
                                                            <div className="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-emerald-400">
                                                                <ChevronIcon expanded={false} className="w-4 h-4" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div className="overflow-y-auto overflow-x-hidden flex-1 no-scrollbar">
                                                    <ul className="divide-y divide-gray-800/50">
                                                        {selectedYear && yearGroups[selectedYear] && (() => {
                                                            const data = yearGroups[selectedYear];
                                                            const sortedGolfers = Object.keys(data.golfers).sort((a,b) => data.golfers[b].total - data.golfers[a].total);
                                                            const maxRax = Math.max(...Object.values(data.golfers).map(g => g.total));
                                                            
                                                            return sortedGolfers.map((gId, index) => {
                                                                const isExpanded = expandedYearPlayer === gId;
                                                                let monthlyData = {};
                                                                if (isExpanded) {
                                                                    data.golfers[gId].events.forEach(e => {
                                                                        const md = e.date.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/);
                                                                        if (md) {
                                                                            const monthIdx = parseInt(md[2]);
                                                                            const monthName = monthsList[monthIdx - 1] || "Unknown";
                                                                            if (!monthlyData[monthName]) monthlyData[monthName] = { total: 0, days: [], mIdx: monthIdx };
                                                                            monthlyData[monthName].total += e.rax;
                                                                            const dVal = parseInt(md[3]);
                                                                            const existingDay = monthlyData[monthName].days.find(d => d.day === dVal);
                                                                            if (existingDay) existingDay.rax += e.rax;
                                                                            else monthlyData[monthName].days.push({ day: dVal, rax: e.rax });
                                                                        }
                                                                    });
                                                                }
                                                                const sortedMonths = Object.entries(monthlyData).sort((a,b) => a[1].mIdx - b[1].mIdx);

                                                                return (
                                                                    <li key={gId} className="flex flex-col group border-l-4 border-transparent hover:border-emerald-500 transition-all">
                                                                        <button 
                                                                            onClick={() => setExpandedYearPlayer(isExpanded ? null : gId)}
                                                                            className="px-4 sm:px-6 md:px-8 py-4 sm:py-5 flex flex-row justify-between items-center hover:bg-emerald-500/5 transition-all w-full text-left gap-3"
                                                                        >
                                                                            <div className="flex items-center gap-3 sm:gap-5 truncate">
                                                                                <div className="flex shrink-0 items-center justify-center w-7 h-7 sm:w-8 sm:h-8 rounded-full golf-ball-rank text-[10px] sm:text-xs font-black text-gray-900 border border-gray-300">
                                                                                    {index + 1}
                                                                                </div>
                                                                                <div className="truncate">
                                                                                    <span className="font-black text-gray-100 text-sm sm:text-lg uppercase tracking-tight truncate group-hover:text-emerald-400 transition-colors">
                                                                                        {getDisplayName(gId)}
                                                                                    </span>
                                                                                </div>
                                                                            </div>
                                                                            <div className="text-right flex items-center gap-3 sm:gap-4 shrink-0 pl-2">
                                                                                <span className="text-gray-100 font-black text-lg sm:text-xl tracking-tighter">
                                                                                    {data.golfers[gId].total.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 1 })}
                                                                                </span>
                                                                                <ChevronIcon expanded={isExpanded} className="text-gray-600 group-hover:text-emerald-500" />
                                                                            </div>
                                                                        </button>
                                                                        {isExpanded && (
                                                                            <div className="bg-gray-950/40 px-4 sm:px-8 py-4 sm:py-6 border-t border-gray-800 animate-fade-in">
                                                                                <div className="space-y-6">
                                                                                    {sortedMonths.map(([month, mData]) => (
                                                                                        <div key={month} className="flex flex-col">
                                                                                            <div className="flex justify-between items-center mb-3 pb-1.5 border-b border-gray-800">
                                                                                                <h4 className="text-[10px] sm:text-xs font-black text-gray-500 uppercase tracking-widest">{month}</h4>
                                                                                                <span className="text-[9px] font-black text-emerald-400 bg-emerald-950/40 px-2 py-0.5 rounded border border-emerald-500/20 uppercase">
                                                                                                    {mData.total.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 1 })} Total
                                                                                                </span>
                                                                                            </div>
                                                                                            <ul className="grid grid-cols-1 sm:grid-cols-2 gap-2">
                                                                                                {mData.days.sort((a,b) => a.day - b.day).map((dayItem, dIdx) => (
                                                                                                    <li key={dIdx} className="flex justify-between items-center px-3 py-2.5 rounded-lg bg-gray-900 border border-gray-800">
                                                                                                        <span className="text-gray-400 font-bold text-[10px] uppercase">{month} {dayItem.day}</span>
                                                                                                        <span className="text-emerald-400 font-black text-xs">+{dayItem.rax.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 1 })}</span>
                                                                                                    </li>
                                                                                                ))}
                                                                                            </ul>
                                                                                        </div>
                                                                                    ))}
                                                                                </div>
                                                                            </div>
                                                                        )}
                                                                    </li>
                                                                );
                                                            });
                                                        })()}
                                                    </ul>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        )}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
